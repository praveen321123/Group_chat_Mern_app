<!DOCTYPE html>
<html>
<head>
  <title>Chat Room</title>
</head>
<body>
  <h1>Group Chat</h1>
  
  <form method="post" action="/send-message">
    <input type="hidden" name="username" id="username" value="">
    <label for="message">Message:</label>
    <input type="text" id="message" name="message" required>
    <button type="submit">Send</button>
  </form>

  <div id="chat-box"></div>

  <script>
    const username = localStorage.getItem('username');
    if (!username) {
      window.location.href = '/login';
    } else {
      document.getElementById('username').value = username;
    }

    function loadMessages() {
      fetch('/messages')
        .then(response => response.json())
        .then(messages => {
          const chatBox = document.getElementById('chat-box');
          chatBox.innerHTML = '';
          messages.forEach(msg => {
            const div = document.createElement('div');
            div.textContent = `${msg.username}: ${msg.message}`;
            chatBox.appendChild(div);
          });
        });
    }
    
    setInterval(loadMessages, 3000);
  </script>
</body>
</html>
